<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="aglcontainerwebm.css" type="text/css" media="screen and (max-width:740px)">
<link rel="stylesheet" href="aglcontainerweb.css" type="text/css" media="screen and (min-width:740px)">
<title>Automotive Grade Linux Container Demo</title>
</head>
<body id="resource-control">
<div class="container-allitem">
<div>
<center><h2> Resource control demo </h2></center>
<center><h3>
When you push gear icon on momiscreen, mom ivi will cause heavy load status.<br>
</h3></center>
</div>
<div class="container-ivi">
     <div class="container-item" id="agl-momi-ivi-demo" onclick="MomiClick()">
          <div class="container-item-box">
               <img class="container-item-img" src="image/momilogo.png" alt="Automotive Grade Linux">
               <h4 class="container-item-txt"><b>AGL MOMI IVI Demo</b><br><br>If container manager was not control cpu resource, instrument cluster will slow down.<br>It's unsafe.</h4>
          </div>
     </div>
     <div class="container-item" id="agl-momi-ivi-demo-res" onclick="SafeMomiClick()">
          <div class="container-item-box">
               <img class="container-item-img" src="image/momilogo_s.png" alt="Automotive Grade Linux">
               <h4 class="container-item-txt"><b>Safe AGL MOMI IVI Demo</b><br><br>If container manager was not control cpu resource, instrument cluster will keep stable behavior.<br>It's safe.</h4>
          </div>
     </div>
</div>
</div>
<div class="cpu-usage">
     <div class="cpu-usage-sub">
     <div><label for="cpu0">cpu0:</label><br><progress class="cpu-progress" id="cpu0" max="100" value="0"></progress></div>
     <div><label for="cpu1">cpu1:</label><br><progress class="cpu-progress" id="cpu1" max="100" value="0"></progress></div>
     <div><label for="cpu2">cpu2:</label><br><progress class="cpu-progress" id="cpu2" max="100" value="0"></progress></div>
     <div><label for="cpu3">cpu3:</label><br><progress class="cpu-progress" id="cpu3" max="100" value="0"></progress></div>
     </div>
     <div class="cpu-usage-sub">
     <div><label for="cpu4">cpu4:</label><br><progress class="cpu-progress" id="cpu4" max="100" value="0"></progress></div>
     <div><label for="cpu5">cpu5:</label><br><progress class="cpu-progress" id="cpu5" max="100" value="0"></progress></div>
     <div><label for="cpu6">cpu6:</label><br><progress class="cpu-progress" id="cpu6" max="100" value="0"></progress></div>
     <div><label for="cpu7">cpu7:</label><br><progress class="cpu-progress" id="cpu7" max="100" value="0"></progress></div>
     </div>
</div>
</div>
</p>
<p>
<center>
<a href="index.html"><img class="demochange-img" src="image/demo_change.png" alt="Demo change"></a>Demo change.
</center>
</p>
<script>
function MomiClick(){
     const res = fetch("cgi-bin/momi.cgi");
}
function SafeMomiClick(){
     const res = fetch("cgi-bin/safemomi.cgi");
}
//setTimeout(StatusGet, 1000);
function StatusGet(){
     fetch("cgi-bin/status.cgi")
          .then(response => response.text())
          .then(
               data => {
                    ShowGuestStatus(data);
               }
          );
     fetch("cgi-bin/cpu.cgi")
          .then(response => response.text())
          .then(
               data => {
                    ShowCpuUsage(data);
               }
          );
     setTimeout(StatusGet, 1000);
}
function ShowGuestStatus(jsondata){
     var status = JSON.parse(jsondata);

     var row_count = status["guest-status"].length;
     for(var i=0; i < row_count;i++) {
          var name = status["guest-status"][i]["guest-name"];
          var stat = status["guest-status"][i]["status"];
          var elem = document.getElementById(name);

          if (elem != null) {
               if (stat == "started") {
                    elem.style.borderColor ="#68ff68";
               } else if (stat == "shutdown") {
                    elem.style.borderColor ="#c8c8ff";
               } else if (stat == "dead") {
                    elem.style.borderColor ="#ff8080";
               } else {
                    elem.style.borderColor ="#a0a0a0";
               }
          }
     }
}
function ShowCpuUsage(jsondata){
     var cpuusage = JSON.parse(jsondata);

     var elem;
     elem = document.getElementById("cpu0");
     elem.value = cpuusage["cpuusage"]["0"];
     elem = document.getElementById("cpu1");
     elem.value = cpuusage["cpuusage"]["1"];
     elem = document.getElementById("cpu2");
     elem.value = cpuusage["cpuusage"]["2"];
     elem = document.getElementById("cpu3");
     elem.value = cpuusage["cpuusage"]["3"];
     elem = document.getElementById("cpu4");
     elem.value = cpuusage["cpuusage"]["4"];
     elem = document.getElementById("cpu5");
     elem.value = cpuusage["cpuusage"]["5"];
     elem = document.getElementById("cpu6");
     elem.value = cpuusage["cpuusage"]["6"];
     elem = document.getElementById("cpu7");
     elem.value = cpuusage["cpuusage"]["7"];

}

function BombClick(){
     const res = fetch("cgi-bin/bomb.cgi");
}
</script>

</body>
</html>
